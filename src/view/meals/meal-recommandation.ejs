<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NutriTrack • Analyse d'un repas</title>
  <link rel="stylesheet" href="/output.css" />
</head>
<body class="min-h-screen bg-[#F9FAFB] font-sans text-[#111827]">
  <div class="flex min-h-screen">

    <main class="flex-1">
      <div class="h-14 md:h-16"></div>

      <section class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
        <header class="mb-6">
          <h1 class="text-[28px] leading-8 md:text-[30px] font-semibold mb-4">Recommandations personnalisées</h1>
          <p class="text-[#6B7280] text-sm">Découvrez des repas adaptés à votre objectif nutritionnel.</p>
        </header>

        <% if (recommendations && recommendations.length > 0) { %>
          <% recommendations.forEach(function(recommendation) { %>
            <div class="mt-6 bg-white border border-[#E5E7EB] rounded-xl shadow-card">
              <div class="p-6 sm:p-8">
                <div class="flex items-start gap-4 mb-4">
                  <% if (recommendation.image_url) { %>
                    <img src="<%= recommendation.image_url %>" alt="<%= recommendation.description %>" class="w-20 h-20 object-cover rounded-lg">
                  <% } %>
                  <div class="flex-1">
                    <h2 class="font-semibold text-[16px] mb-2"><%= recommendation.description %></h2>
                    <p class="text-[#6B7280] text-sm">Objectif: <%= recommendation.goal %></p>
                  </div>
                </div>

                <% if (recommendation.ingredients && recommendation.ingredients.length > 0) { %>
                  <div class="mb-4">
                    <p class="text-[#6B7280] text-sm mb-2">Ingrédients principaux:</p>
                    <div class="flex flex-wrap gap-2">
                      <% recommendation.ingredients.slice(0, 3).forEach(function(ingredient) { %>
                        <span class="inline-block bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm">
                          <%= typeof ingredient === 'string' ? ingredient : (ingredient.name || ingredient) %>
                        </span>
                      <% }); %>
                      <% if (recommendation.ingredients.length > 3) { %>
                        <span class="inline-block text-[#6B7280] px-3 py-1 text-sm">
                          +<%= recommendation.ingredients.length - 3 %> autres
                        </span>
                      <% } %>
                    </div>
                  </div>
                <% } %>

                <div class="mt-5 grid grid-cols-2 gap-4 text-center text-[13px]">
                  <% if (recommendation.calories) { %>
                    <div class="col-span-1 border border-[#E5E7EB] rounded-xl py-4">
                      <div class="text-[20px] font-semibold leading-none"><%= recommendation.calories %></div>
                      <div class="text-[#6B7280] mt-1">kcal Total</div>
                    </div>
                  <% } %>
                  <% if (recommendation.protein) { %>
                    <div class="col-span-1 border border-[#E5E7EB] rounded-xl py-4">
                      <div class="text-[20px] font-semibold leading-none text-[#22C55E]"><%= recommendation.protein %>g</div>
                      <div class="text-[#6B7280] mt-1">Protéines</div>
                    </div>
                  <% } %>
                </div>

                <div class="mt-5">
                  <a href="/details/<%= recommendation.id %>">
                    <button class="w-full bg-[#22C55E] hover:bg-[#22C55E]Dark text-white font-medium py-3 rounded-md cursor-pointer">Voir les détails</button>
                  </a>
                </div>
              </div>
            </div>
          <% }); %>
        <% } else { %>
          <div class="mt-6 bg-white border border-[#E5E7EB] rounded-xl shadow-card">
            <div class="p-6 sm:p-8 text-center">
              <div class="text-[#6B7280] text-lg mb-2">Aucune recommandation disponible</div>
              <p class="text-[#6B7280] text-sm">
                <% if (!user.goal) { %>
                  Veuillez définir votre objectif nutritionnel pour recevoir des recommandations personnalisées.
                <% } else { %>
                  Aucune recommandation n'est disponible pour votre objectif (<%= user.goal %>).
                <% } %>
              </p>
            </div>
          </div>
        <% } %>

      </section>
    </main>
  </div>
</body>
</html>
